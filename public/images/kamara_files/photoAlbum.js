define("modules/photoAlbum",["jquery_visible","jquery","modules/helpers/googletagHelper","modules/core/carouselCore","modules/services/carousel/keyboardNavigationService","addons/services/adobeLaunchService"],function(t,e,o,n,i,a){return function(){var t,r=function(t,e){void 0===e&&(e=!1),"function"==typeof jQuery&&t instanceof jQuery&&(t=t[0]);var o=t.getBoundingClientRect(),n=window.innerHeight||document.documentElement.clientHeight,i=window.innerWidth||document.documentElement.clientWidth;if(e){var a=o.top<=n&&o.top+o.height>=0,r=o.left<=i&&o.left+o.width>=0;return a&&r}return o.left>=0&&o.top>=0&&o.left+o.width<=i&&o.top+o.height<=n},l="scrollBehavior"in document.documentElement.style,s=e(window),u={ids:[],campaignID:void 0,size:void 0,slots:[]},c=Object.freeze({carousel:"carousel",grid:"grid",lightbox:"lightbox",list:"list"}),d={elements:{selector:".nfl-c-photo-album__carousel-view",rootElement:".nfl-c-photo-album",lightbox:".nfl-c-photo-album--lightbox",grid:".nfl-c-photo-album--grid",list:".nfl-c-photo-album--list",inArticle:".nfl-c-photo-album--in-article",carouselView:".nfl-c-photo-album__carousel-view",listView:".nfl-c-photo-album__list-view",gridView:".nfl-c-photo-album__grid-view",progress:".nfl-c-photo-album__progress",prevButton:".nfl-c-photo-album__prev",nextButton:".nfl-c-photo-album__next",owlElement:".owl-carousel",gridButton:".nfl-c-photo-album__grid-button",listButton:".nfl-c-photo-album__list-button",carouselButton:".nfl-c-photo-album__carousel-button",advCloseButton:".nfl-c-photo-album__adv-close",advContent:".nfl-c-photo-album__adv--carousel",wrapper:".nfl-c-photo-album__picture-wrapper",share:".nfl-c-photo-album__share",timerSelector:".nfl-c-photo-album__adv-timer-countdown",lightboxOpenButton:".nfl-c-photo-album__enlarge-button",albumHeader:".nfl-c-photo-album__header",picturesContainer:".nfl-c-photo-album__pictures-container",lightboxCloseButton:".nfl-c-photo-album__lightbox-close",lightboxCloseButtonHidden:".nfl-c-photo-album__lightbox-close--hidden"},owlCarousel:{loop:!1,dots:!1,nav:!1,mouseDrag:!0,touchDrag:!1,margin:0,items:1,responsive:{0:{mouseDrag:!1,touchDrag:!0},768:{mouseDrag:!0,touchDrag:!0}}},adv:{frequency:10,duration:3},hashChange:!0},p=function(t,e){if(e.property&&e.property.name&&"position"===e.property.name){if(++t.viewedCount===t.options.adv.frequency-1)return void w(t,{ignoreExcludedAds:!0});t.viewedCount===t.options.adv.frequency&&(m(t),D(t),t.viewedCount=0)}},m=function(t){t.options.adv.duration&&(t.$target.addClass("nfl-c-photo-album__adv--visible"),O(t),t.$advCloseButton.show(),t.$advCloseButton.off("click.photoalbum.adv").on("click.photoalbum.adv",h(t)),g(t),t.durationTO=setTimeout(h(t),1e3*t.options.adv.duration))},f=function(t){var e=t.$advContent.find(".d3-o-adv-block").find("iframe").first().contents().find("a");t.$owlElement.on("translated.owl.carousel",function(t){e.focus()})},h=function(t){return function(){t.$target.removeClass("nfl-c-photo-album__adv--visible"),O(t),t.durationTO&&clearTimeout(t.durationTO),t.countdownID&&(clearInterval(t.countdownID),e(t.options.elements.timerSelector).hide()),t.viewedCount=0,t.$target.hasClass("nfl-c-photo-album--lightbox")&&!t.$target.has(".nfl-c-photo-album__next--disabled").length?P(t.$nextButton):t.$target.hasClass("nfl-c-photo-album--lightbox")?P(t.$lightboxCloseButton):t.$carouselOuterStage.data("focus-active")&&P(e(".owl-item.active "+t.options.elements.lightboxOpenButton)),o.clearSlot(t.$target.find(".nfl-c-photo-album__adv .d3-o-adv-block").attr("id"))}},w=function(t,o){void 0===o&&(o={ignoreExcludedAds:!1});var n=".nfl-c-photo-album__adv";switch(t.view.currentView){case c.carousel:case c.lightbox:n+="--carousel";break;case c.list:n+="--list"}var i=t.$target.find(n+" .d3-o-adv-block--refreshable");o.ignoreExcludedAds?i.push(t.$target.find(".d3-l-grid--article-series .d3-o-adv-block--refreshable").not(".js-lightbox-refresh-ignore")):i.push(t.$target.find(".d3-l-grid--article-series .d3-o-adv-block--refreshable")),e.each(i,function(t,o){var n=e(o).attr("id");v(n)})},v=function(t){t&&window[t+"_refreshAdv"]&&"function"==typeof window[t+"_refreshAdv"]&&window[t+"_refreshAdv"]()},g=function(t){if(t.$target.hasClass("nfl-c-photo-album__adv--visible")){var o=t.$target.find(".d3-adv-timer-countdown-content");if(o.length){f(t);var n=t.options.adv.duration;o.html(n),e(t.options.elements.timerSelector).show(),t.countdownID&&clearInterval(t.countdownID),t.countdownID=setInterval(function(){o.html(--n)},1e3)}}},b=function(t){if(!u.ids.length){var e=t.$target.find(".advertisement-list-view .nfl-c-photo-album__adv--list");u.campaignID=e.data("campaignid"),u.size=e.data("size");var n=e.data("index"),i=n.split("|"),a=i.length,r=0;for(r=0;r<a;r++){var l=e.clone();l.removeAttr("data-index");var s=t.$wrappers.eq(i[r]),c=s.data("id");l.find(".nfl-c-photo-album__adv-content").attr("id",c),s.after(l),u.ids.push(c)}}requestAnimationFrame(function(){u.slots=o.setSlots(u)})},$=function(t){var e=t.$target.find(t.options.elements.listView).find(".nfl-c-photo-album__adv--list");e&&e.length&&e.remove(),o.destroySlots(u.slots),u.ids=[]},_=function(t){return function(){B(t),G(t),H(t,"0")}},C=function(t){return function(){A(t),t.$wrappers.each(function(e){this.getAttribute("data-viewport")||r(this,!0)&&(this.setAttribute("data-viewport",!0),G(t,{item:{index:e}}))}),H(t,"0")}},x=function(t){return function(){E(t),requestAnimationFrame(function(){G(t)})}},B=function(e){it(e,!0),e.view.currentView=c.grid,$(e),e.$owlElement.trigger("destroy.owl.carousel"),t&&cancelAnimationFrame(t),e.$photoAlbum.removeClass("nfl-c-photo-album--list").addClass("nfl-c-photo-album--grid"),e.$owlElement.removeClass().addClass("nfl-c-photo-album__grid-view"),V(e),I(e)},V=function(t){var o=M(t);if(o.length){var n=o.data("id");if(n){var i=e("#"+n);i&&i.length&&(P(i),S(i))}}},y=function(e){t=requestAnimationFrame(function(){e(),y(e)})},A=function(t){it(t,!0),t.view.currentView=c.list,t.$owlElement.trigger("destroy.owl.carousel"),t.$photoAlbum.removeClass("nfl-c-photo-album--grid").addClass("nfl-c-photo-album--list"),t.$owlElement.removeClass().addClass("nfl-c-photo-album__list-view"),t.$wrappers.removeAttr("data-viewport"),t.$wrappers.first().attr("data-viewport",!0),y(function(){X(t,{})}),requestAnimationFrame(function(){b(t)}),V(t),I(t)},E=function(e){e.view.currentView=c.carousel,$(e),e.$owlElement.trigger("destroy.owl.carousel"),t&&cancelAnimationFrame(t),e.$photoAlbum.removeClass("nfl-c-photo-album--list nfl-c-photo-album--grid").addClass("nfl-c-photo-album"),e.$owlElement.removeClass().addClass("nfl-c-photo-album__carousel-view owl-carousel owl-loaded owl-drag"),requestAnimationFrame(function(){U(e)}),I(e),Y(e)},k=function(o,n){if(o.view.previousView=o.view.currentView,o.view.currentView===c.grid||o.view.currentView===c.list){var i=e(n.target).parents(o.options.elements.wrapper);o.startPosition=o.$wrappers.index(i)}o.view.currentView=c.lightbox,Z(o),o.$target.parent().addClass("photo-album-parent"),o.$target.prependTo("body"),o.$d3lWrap.hide(),o.$body.addClass("body--lightbox"),t&&cancelAnimationFrame(t),o.$target.addClass(o.options.elements.lightbox.substr(1)),o.isInArticle&&o.$target.addClass(o.options.elements.inArticle.substr(1)),o.$target.removeClass(o.options.elements.rootElement.substr(1)),o.$lightboxCloseButton.removeClass(o.options.elements.lightboxCloseButtonHidden.substr(1)).addClass(o.options.elements.lightboxCloseButton.substr(1)),E(o),o.view.currentView=c.lightbox,o.$albumHeader.prependTo(o.$target.find(".owl-stage-outer")),requestAnimationFrame(function(){G(o)}),P(o.$target.has(".nfl-c-photo-album__next--disabled").length?o.$lightboxCloseButton:o.$nextButton),o.$lightboxCloseButton.off("click.photoalbum").one("click.photoalbum",function(t){q(o,t)})},q=function(t,o){var n=e(t.options.elements.lightbox);n.appendTo(".photo-album-parent"),n.addClass(t.options.elements.rootElement.substr(1)),t.$target.removeClass(t.options.elements.lightbox.substr(1)),t.$target.removeClass(t.options.elements.inArticle.substr(1)),t.$d3lWrap.show(),t.$body.removeClass(".body--lightbox".substr(1)),t.$lightboxCloseButton.removeClass(t.options.elements.lightboxCloseButton.substr(1)).addClass(t.options.elements.lightboxCloseButtonHidden.substr(1)),e(t.options.elements.rootElement).parent(".photo-album-parent").removeClass("photo-album-parent"),t.$albumHeader.insertBefore(t.$picturesContainer),t.view.previousView===c.list&&(A(t),w(t),G(t),S(t.$wrappers.eq(t.startPosition))),t.view.previousView===c.grid&&(B(t),w(t),G(t),S(t.$wrappers.eq(t.startPosition))),t.view.previousView===c.carousel&&(E(t),w(t),G(t),t.$owlElement.on("initialized.owl.carousel",function(){t.$carouselOuterStage.data("focus-active",!0),e(".owl-item.active "+t.options.elements.lightboxOpenButton).focus()})),t.isInArticle&&(P(t.$picturesContainer),S(t.$target))},I=function(t){switch(t.view.currentView){case c.carousel:t.$carouselButton.addClass("nfl-c-photo-album__carousel-button--active"),t.$gridButton.removeClass("nfl-c-photo-album__grid-button--active"),t.$listButton.removeClass("nfl-c-photo-album__list-button--active");break;case c.grid:t.$gridButton.addClass("nfl-c-photo-album__grid-button--active"),t.$carouselButton.removeClass("nfl-c-photo-album__carousel-button--active"),t.$listButton.removeClass("nfl-c-photo-album__list-button--active"),S(t.$wrappers.eq(t.startPosition));break;case c.list:t.$listButton.addClass("nfl-c-photo-album__list-button--active"),t.$carouselButton.removeClass("nfl-c-photo-album__carousel-button--active"),t.$gridButton.removeClass("nfl-c-photo-album__grid-button--active"),S(t.$wrappers.eq(t.startPosition))}},O=function(t){t.$albumHeader.find("button").prop("disabled",t.$target.hasClass("nfl-c-photo-album__adv--visible"))},D=function(t){t.$advContent.find(".d3-o-adv-block").find("iframe").first().contents().find("a").off("keydown.photoalbum").on("keydown.photoalbum",function(e){27===e.which&&t.$advCloseButton.trigger("click")})},P=function(t){t&&t.length&&t.focus&&t.focus()},S=function(t){t&&t.length&&t.get(0).scrollIntoView(!l||{behavior:"auto",block:"center",inline:"nearest"})},F=function(t){t.preventDefault(),t.stopPropagation()},H=function(t,o){t.$target.find(t.options.elements.lightboxOpenButton).each(function(t,n){e(n).attr("tabindex",o)})},z=function(t,o){o.view.currentView===c.carousel&&(H(o,"-1"),o.$owlElement.on("initialized.owl.carousel",function(t){o.$carouselOuterStage.attr("tabindex")||o.$carouselOuterStage.attr("tabindex","0")}),i.init(o.$owlElement,o.options.elements.lightboxOpenButton)),o.$picturesContainer.off("keydown.photoalbum").on("keydown.photoalbum",function(t){if(9===t.which||13===t.which||27===t.which||37===t.which||39===t.which){var n=(e(t.target),t.shiftKey),i=o.$picturesContainer,a=i.find(d.elements.selector).data("owl.carousel"),r=e(document.activeElement);switch(t.which){case 9:if(n)switch(o.view.currentView){case c.carousel:case c.lightbox:case c.grid:case c.list:}else switch(o.view.currentView){case c.carousel:case c.lightbox:case c.grid:case c.list:}break;case 13:r.is(o.options.elements.lightboxOpenButton)&&(r.trigger("click"),F(t));break;case 27:if(o.$target.hasClass("nfl-c-photo-album__adv--visible"))return h(o),void F(t);o.view.currentView===c.lightbox&&(q(o,t),F(t));break;case 37:if(o.view.currentView===c.carousel||o.view.currentView===c.lightbox&&!r.is(o.options.elements.lightboxOpenButton))return void a.prev();if(o.view.currentView===c.grid||o.view.currentView===c.list)return o.startPosition-=1,void P(o.$wrappers.eq(o.startPosition));break;case 39:if(o.view.currentView===c.carousel||o.view.currentView===c.lightbox&&!r.is(o.options.elements.lightboxOpenButton))return void a.next();if(o.view.currentView===c.grid||o.view.currentView===c.list)return o.startPosition+=1,void P(o.$wrappers.eq(o.startPosition))}}})},N=function(t){t.$prevButton.off("click.photoalbum.nav.prev").on("click.photoalbum.nav.prev",function(e){t.prevEnabled&&(t.$target.hasClass("nfl-c-photo-album__adv--visible")||t.$owlElement.trigger("prev.owl.carousel"))})},T=function(t){t.$nextButton.off("click.photoalbum.nav.next").on("click.photoalbum.nav.next",function(e){t.nextEnabled&&(t.$target.hasClass("nfl-c-photo-album__adv--visible")||t.$owlElement.trigger("next.owl.carousel"))})},j=function(t,e){t.prevEnabled=e,e?t.$prevButton.removeClass("nfl-c-photo-album__prev--disabled"):t.$prevButton.addClass("nfl-c-photo-album__prev--disabled")},W=function(t,e){t.nextEnabled=e,e?t.$nextButton.removeClass("nfl-c-photo-album__next--disabled"):t.$nextButton.addClass("nfl-c-photo-album__next--disabled")},L=function(t,o){if(o&&t.options.hashChange){var n=e(o.target),i=n.find(t.options.elements.wrapper).eq(o.item.index);i.length&&(window.location.hash="#"+i.attr("data-id"))}},Q=function(t,o){if(t.$owlElement&&o&&o.length>1){var n=o.slice(1),i=t.$target.find(t.options.elements.wrapper).filter('[data-id="'+n+'"]');if(i.length){var a=e(".owl-item",t.$owlElement).has(i),r=a.index(".owl-item");t.$owlElement.trigger("to.owl.carousel",[r,0]),it(t),requestAnimationFrame(function(){Z(t)})}}},K=function(t,e){var o=((e||{}).item||{}).index||0,n=e&&e.targetItem?e.targetItem:t.$target.find(t.options.elements.wrapper).eq(o);if(n.length){var i={photoName:n.attr("data-name"),pageState:t.view.currentView+" view"};J(i)}},R=function(t,e){var o=t.$target.find(t.options.elements.wrapper).eq(0);if(o.length){var n={photoName:o.attr("data-name"),pageState:t.view.currentView+" view"};J(n)}},G=function(t,o){var n;if(t.view.currentView===c.list)return void K(t,o);if(t.view.currentView===c.grid)return void R(t);if(!o&&(t.view.currentView===c.carousel||t.view.currentView===c.lightbox)){var i=M(t);return void(i.length&&(n={photoName:i.attr("data-name"),pageState:t.isInArticle&&t.view.currentView===c.carousel?"article carousel":t.view.currentView+" view"},t.isInArticle&&(n.articleName="",n.articleID="",n.galleryName=i.parents("[data-gallery-name]").attr("data-gallery-name"),n.galleryID=t.$target.data("gallery-id")),J(n)))}if(o&&o.property&&o.property.name&&"position"===o.property.name){var a=e(o.target),r=a.find(t.options.elements.wrapper).eq(o.item.index);r.length&&(n={photoName:r.attr("data-name"),pageState:t.isInArticle&&t.view.currentView===c.carousel?"article carousel":t.view.currentView+" view"},t.isInArticle&&(n.articleName="",n.articleID="",n.galleryName=r.parents("[data-gallery-name]").attr("data-gallery-name"),n.galleryID=t.$target.data("gallery-id")),J(n))}},J=function(t){window._satellite&&t&&a.link(window._satellite,e.extend(!0,{},window.utag_data,t),"photo_album")},M=function(t){switch(t.view.currentView){case c.lightbox:case c.carousel:return t.$target.find(".owl-item.active "+t.options.elements.wrapper);case c.grid:case c.list:return e()}return e()},U=function(t){t.options.owlCarousel.startPosition=t.startPosition;var e={selector:t.options.elements.selector,owlCarousel:t.options.owlCarousel},o=new n.core(e);z(0,t),o.initOwl()},X=function(o,n){var i=o.$wrappers.filter(":not([data-viewport])");if(!i.length)return void cancelAnimationFrame(t);i.each(function(){var t=e(this);r(this,!0)&&(this.getAttribute("data-viewport")||(t.attr("data-viewport",!0),n.targetItem=t,requestAnimationFrame(function(){v(t.find(".d3-o-adv-block--refreshable").attr("id")),G(o,n)})))})},Y=function(t,e){requestAnimationFrame(function(){Z(t)})},Z=function(t){var e,o,n,i,a;if((e=M(t))&&!(e.length<1)&&(t.$wrappers.eq(0).show(),o=t.$wrappers.first().find("img"),o.length)){if(t.view.currentView===c.lightbox)return n=e.find(t.options.elements.progress),i=n.find("span"),a=o.height()+i.position().top,t.$prevButton.css({top:a,left:"30%"}).show(),void t.$nextButton.css({top:a,right:"30%"}).show();if(t.isInArticle)return n=e.find(t.options.elements.progress),i=n.find("span"),a=o.height()+i.position().top,t.$prevButton.css({top:a}).show(),void t.$nextButton.css({top:a}).show();if(s.outerWidth()>=1024)return a=o.position().top+o.height()/2-t.$prevButton.height()/2,t.$prevButton.css({top:a,left:4}).show(),void t.$nextButton.css({top:a,right:4}).show();n=e.find(t.options.elements.progress),i=n.find("span"),a=o.height()+i.position().top,t.$prevButton.css({top:a,left:"30%"}).show(),t.$nextButton.css({top:a,right:"30%"}).show()}},tt=function(t){N(t),T(t),t.$owlElement.on("initialized.owl.carousel",function(e){t.$carouselOuterStage=t.$owlElement.find(".owl-stage-outer")}),t.$gridButton.off("click.photoalbum.grid").on("click.photoalbum.grid",_(t)),t.$listButton.off("click.photoalbum.list").on("click.photoalbum.list",C(t)),t.$carouselButton.off("click.photoalbum.default").on("click.photoalbum.default",x(t)),t.$window.off("resize.photoalbum").on("resize.photoalbum",function(e){Y(t,e)}),t.$owlElement.on("resized.owl.carousel",function(e){Y(t,e)}),t.$owlElement.on("changed.owl.carousel",function(e){et(t,e)}),t.$owlElement.on("translated.owl.carousel",function(e){ot(t,e)}),t.$owlElement.on("initialized.owl.carousel",function(e){nt(t,e)}),t.$lightboxOpenButton.off("click.photoalbum.lightbox").on("click.photoalbum.lightbox",function(e){k(t,e)}),j(t,!1),W(t,!0),Y(t),t.view.currentView===c.grid&&B(t),t.view.currentView===c.list&&A(t),t.view.currentView===c.carousel&&E(t)},et=function(t,e){e.property&&e.property.name&&"position"===e.property.name&&(t.startPosition=e.item.index),W(t,e.item.index+1<e.item.count),j(t,0!==e.item.index),G(t,e),p(t,e),L(t,e)},ot=function(t,e){it(t)},nt=function(t,e){it(t)},it=function(t,e){if(e)return void t.$wrappers.show();var o=t.startPosition-1,n=t.startPosition+1,i=t.$wrappers.eq(o),a=t.$wrappers.eq(t.startPosition),r=t.$wrappers.eq(n);i.show(),a.show(),r.show(),t.$wrappers.not(i).not(a).not(r).hide()};return{options:{},initByElement:function(t){var o={},n=o;n.$body=e("body"),n.$window=e(window),n.$d3lWrap=e(".d3-l-wrap"),n.viewedCount=0,n.startPosition=0,n.$target=e(t),n.options=e.extend(!0,{},d),n.$photoAlbum=e(n.options.elements.rootElement),n.$progress=n.$target.find(n.options.elements.progress),n.$prevButton=n.$target.find(n.options.elements.prevButton),n.$nextButton=n.$target.find(n.options.elements.nextButton),n.$owlElement=n.$target.find(n.options.elements.owlElement),n.$gridButton=n.$target.find(n.options.elements.gridButton),n.$listButton=n.$target.find(n.options.elements.listButton),n.$carouselButton=n.$target.find(n.options.elements.carouselButton),n.$advCloseButton=n.$target.find(n.options.elements.advCloseButton),n.$advContent=n.$target.find(n.options.elements.advContent),n.$wrappers=n.$target.find(n.options.elements.wrapper),n.$share=n.$target.find(n.options.elements.share),n.$lightboxOpenButton=n.$target.find(n.options.elements.lightboxOpenButton),n.$albumHeader=n.$target.find(n.options.elements.albumHeader),n.$picturesContainer=n.$target.find(n.options.elements.picturesContainer),n.$lightboxCloseButton=n.$target.find(n.options.elements.lightboxCloseButton),n.sharebar=void 0,n.nextEnabled=!1,n.prevEnabled=!1,n.isInArticle=!1,n.view={defaultView:c.carousel,currentView:c.carousel,previousView:c.carousel},n.setActiveItemByHash=Q,n.isInArticle=!!n.$target.parents(".nfl-c-article").length,n.view.currentView=(n.$target.attr("data-view")||"").toLowerCase(),n.isInArticle&&(n.view.currentView=c.carousel);for(var i=window.location.hash,a=["data-adv-frequency","data-adv-duration"],r=a.length,l=0;l<r;l++){var u=a[l],p=n.$target.attr(u);if(p&&!isNaN(p)){var m=u.split("data-adv-").join("");n.options.adv[m]=parseInt(p,10)}}var f=n.$target.attr("data-hash-change")||"";return n.options.hashChange="true"===f.toLowerCase(),tt(n),s.one("load.photoalbum",function(){n.view.currentView===c.carousel&&(e(n.options.elements.selector).trigger("refresh.owl.carousel"),Y(n),Q(n,i))}),o}}}()});
//# sourceMappingURL=photoAlbum.js.map