define("modules/helpers/nflTokenHelper",["jquery","modules/services/deferredService","modules/helpers/browserHelper","modules/helpers/stringHelper","modules/helpers/dateHelper"],function(e,r,t,n,o){return function(){return{getClientType:function(){var e="WEB_DESKTOP_DESKTOP";return t.isIOS()&&t.isMobile()?e="WEB_IOS_MOBILE_WEB":t.isIOS()&&t.isTablet()?e="WEB_IOS_TABLET_WEB":t.isAndroid()&&t.isMobile()?e="WEB_ANDROID_MOBILE_WEB":t.isAndroid()&&t.isTablet()&&(e="WEB_ANDROID_TABLET_WEB"),e},getDeviceId:function(){var e=this.getTokenFromLs();return e&&e.rawData&&e.rawData.deviceId?e.rawData.deviceId:n.generateGuid()},isTokenExpired:function(e){return!e||!e.expires||o.getDateByMS(e.expires)<=o.getCurrentDate()||o.getDateByMS(e.expires)>=o.addHours(o.getCurrentDate(),2)},getTokenFromLs:function(){var e=localStorage.getItem("nfl.nflToken");return e?JSON.parse(e):null},getFullToken:function(n){var o=this,i=e.Deferred(),s=o.getTokenFromLs();if(s&&!o.isTokenExpired(s))return i.resolve(s),i.promise();var l={ClientType:o.getClientType(),DeviceId:o.getDeviceId(),Uid:n?n.UID:null,UidSignature:n?n.UIDSignature:null,SignatureTimestamp:n?parseInt(n.signatureTimestamp):null,UserAgent:t.getUserAgent()};return r.postJson("/oauth/nfl/token",l).done(function(e){i.resolve(o.transformToken(e))}).fail(function(){i.resolve(null)}),i.promise()},getMvpdTokenRequestModel:function(){var e=localStorage.getItem("authorizationProviderUserId"),r=localStorage.getItem("deviceInfo"),n=localStorage.getItem("identityProviderId"),o=localStorage.getItem("networkType");return e&&r&&n&&o?{ClientType:this.getClientType(),DeviceId:this.getDeviceId(),UserAgent:t.getUserAgent(),AuthorizationProviderUserId:e,DeviceInfo:btoa(r),IdentityProviderId:n,NetworkType:o}:null},getMvpdToken:function(){var t=this,n=e.Deferred(),o=t.getTokenFromLs();if(o&&!t.isTokenExpired(o))return n.resolve(o),n.promise();var i=t.getMvpdTokenRequestModel();return null===i?(n.resolve(null),n.promise()):(r.postJson("/oauth/nfl/mvpdToken",i).done(function(e){n.resolve(t.transformToken(e))}).fail(function(){n.reject(null)}),n.promise())},transformToken:function(r){if(!r||!r.accessToken)return null;var t=n.parseJwt(r.accessToken);return{expires:1e3*r.expiresIn,rawData:e.extend({},r,t)}},storeToken:function(e){e&&localStorage.setItem("nfl.nflToken",JSON.stringify(e))},removeToken:function(){localStorage.removeItem("nfl.nflToken")}}}()});
//# sourceMappingURL=nflTokenHelper.js.map